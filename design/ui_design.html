<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>User Interface Design &mdash; Developer Documentation 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FAQs" href="faqs.html" />
    <link rel="prev" title="Energy Workflow" href="energy_workflow.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Developer Documentation
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../community/index.html">NWChemEx Community</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Design Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="philosophy.html">NWChemEx Philosophy</a></li>
<li class="toctree-l2"><a class="reference internal" href="vision.html">NWChemEx Visions</a></li>
<li class="toctree-l2"><a class="reference internal" href="nwx_ecosystem.html">NWChemEx Ecosystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="overall_design.html">Overall Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="overall_justifications/index.html">Overall Design Justification</a></li>
<li class="toctree-l2"><a class="reference internal" href="energy_workflow.html">Energy Workflow</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">User Interface Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#design-principles">Design Principles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pythonic">Pythonic</a></li>
<li class="toctree-l4"><a class="reference internal" href="#performant">Performant</a></li>
<li class="toctree-l4"><a class="reference internal" href="#light-weight">Light weight</a></li>
<li class="toctree-l4"><a class="reference internal" href="#user-friendly">User-friendly</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tool-friendly">Tool-friendly</a></li>
<li class="toctree-l4"><a class="reference internal" href="#minimal-i-o">Minimal I/O</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interactive">Interactive</a></li>
<li class="toctree-l4"><a class="reference internal" href="#limited-results">Limited results</a></li>
<li class="toctree-l4"><a class="reference internal" href="#limited-inputs">Limited inputs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#focus-on-common-tasks">Focus on common tasks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#minimal-dependencies">Minimal dependencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#archiving-and-reproducibility">Archiving and reproducibility</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#common-quantum-chemistry-calculations">Common Quantum Chemistry Calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#existing-python-based-uis">Existing Python-based UIs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pyscf">PySCF</a></li>
<li class="toctree-l4"><a class="reference internal" href="#psi4">PSI4</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qcengine">QCEngine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#current-nwchemex-ui">Current NWChemEx UI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#parallel-calculations">Parallel calculations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#not-in-scope">Not In Scope</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="faqs.html">FAQs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../documenting/index.html">Documenting NWChemEx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conventions/index.html">NWChemEx Organization Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coding/index.html">Developing NWChemEx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">Testing NWChemEx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../continuous_deployment/index.html">Continuous Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/index.html">Additional Developer Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography/bibliography.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Developer Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Design Documentation</a></li>
      <li class="breadcrumb-item active">User Interface Design</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/NWChemEx/.github/edit/master/docs/source/design/ui_design.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="user-interface-design">
<h1>User Interface Design<a class="headerlink" href="#user-interface-design" title="Permalink to this heading"></a></h1>
<p>This document outlines the design principles and guidelines for the user
interface (UI) of NWChemEx. Our main goal is to provide a user-friendly and
intuitive interface that enables users to carry out a variety of quantum
chemistry calculations seamlessly. Please note that a graphical user interface
(GUI) is not part of the current UI design. Other possible UI elements that are
not part of the current design are noted here <a class="reference internal" href="#not-in-scope"><span class="std std-ref">Not In Scope</span></a>.</p>
<div class="section" id="design-principles">
<h2>Design Principles<a class="headerlink" href="#design-principles" title="Permalink to this heading"></a></h2>
<div class="section" id="pythonic">
<h3>Pythonic<a class="headerlink" href="#pythonic" title="Permalink to this heading"></a></h3>
<p>While NWChemEx is mainly written in C++ for performance, the UI is designed for
and implemented in Python, which is arguably one of the most intuitive and
widely-used programming languages in scientific computing. This removes the
burden from our users to learn a special syntax, a new domain specific language,
or dealing with customized parsers for extracting data. Moreover, Python’s
extensive ecosystem and user-friendly syntax allow for quicker prototyping and
easier integration with external tools, making it an ideal choice for this
interface. Adhering to the Pythonic style of programming is preferred due to its
emphasis on code readability and simplicity, as described in the Zen of Python
(PEP 20) &lt;<a class="reference external" href="https://peps.python.org/pep-0020/">https://peps.python.org/pep-0020/</a>&gt;_. A more in depth discussion of the
implementation language choices can be found in
<a class="reference internal" href="overall_justifications/why_python.html#why-is-the-nwchemex-api-written-in-python"><span class="std std-ref">Why is the NWChemEx API Written in Python?</span></a>.</p>
</div>
<div class="section" id="performant">
<h3>Performant<a class="headerlink" href="#performant" title="Permalink to this heading"></a></h3>
<p>Performance is critical for NWChemEx with kernels supporting optimized MPI
parallelization and GPU offloading. The UI is designed to uphold this
performance standard and to provide the user with critical control elements to
achieve high performance. This requires keeping the overhead of UI as minimal as
possible by avoiding unnecessary copies or data movements and enabling user to
access and modify the MPI communicator and toggle between CPU-based/GPU-offloaded algorithms.</p>
</div>
<div class="section" id="light-weight">
<h3>Light weight<a class="headerlink" href="#light-weight" title="Permalink to this heading"></a></h3>
<p>Following from performance, the UI should shuttle data into C++ as quickly as
possible.For user convenience some conversions may be necessary (<em>e.g.</em>, our
<cite>Molecule</cite> class is never going to do string parsing), but the set of such
conversions should be minimal, or limited to those supported by some other
library (which we agree to take on as a dependency).</p>
</div>
<div class="section" id="user-friendly">
<h3>User-friendly<a class="headerlink" href="#user-friendly" title="Permalink to this heading"></a></h3>
<p>We aim to make our UI intuitive and simple particularly for the most common use
cases to minimize the learning curve for beginners. The UI is also designed to
provide user-friendly error handling, offering clear and actionable feedback
when something goes wrong, guiding users to resolve issues effectively.</p>
</div>
<div class="section" id="tool-friendly">
<h3>Tool-friendly<a class="headerlink" href="#tool-friendly" title="Permalink to this heading"></a></h3>
<p>In some workflows, NWChemEx can be used as a library driven by another code,
rather than directly by a user. Therefore, our UI needs to avoid assuming that
it is the top layer in order to better integrate into external tools.</p>
<p>The ability to take an MPI communicator is one particularly important UI design
element implied by this combined with the performance consideration. Python-based
interface is also useful to support many external tools easily.</p>
</div>
<div class="section" id="minimal-i-o">
<h3>Minimal I/O<a class="headerlink" href="#minimal-i-o" title="Permalink to this heading"></a></h3>
<p>Many quantum chemistry codes are designed to use input/output (I/O) files as
their primary (sometimes only) user interface. Users are expected to provide
input files in certain format and parse output files to extract the information
required. This is not only cumbersome but also can hinder performance
particularly when the code is used as a library by an external code in
high-throughput mode. The UI should avoid or minimize the I/O by providing the
user with the ability to pass the input and output data directly to the code.
This enables better interactivity and allows for more efficient use of the code
as a library.</p>
</div>
<div class="section" id="interactive">
<h3>Interactive<a class="headerlink" href="#interactive" title="Permalink to this heading"></a></h3>
<p>The UI should support interactivity, allowing users to run the code in a Jupyter
notebook or IPython shell. This is particularly important for beginners who are
not familiar with the code and want to explore its capabilities and for
education. It is also important for visualization and for workflows supporting
machine learning applications.</p>
</div>
<div class="section" id="limited-results">
<h3>Limited results<a class="headerlink" href="#limited-results" title="Permalink to this heading"></a></h3>
<p>In theory, there’s a very large set of results a user could want. Thankfully
most users target the same quantities. The UI should focus on those quantities.</p>
<p>The most common quantities are: energy, molecular-orbital coefficients,
gradients, vibrational frequencies, and geometries (including minimum energy,
transition states, reaction paths, etc.).</p>
</div>
<div class="section" id="limited-inputs">
<h3>Limited inputs<a class="headerlink" href="#limited-inputs" title="Permalink to this heading"></a></h3>
<p>Generally speaking the inputs required for the aforementioned results tend to be
the molecule, level of theory (method plus basis set), and method parameters.
While the set of potential parameters is huge, again there are only a handful of
commonly used parameters.</p>
<p>Primary targets are: algorithm variations (e.g. density fitting), number of
iterations, and convergence criteria.</p>
</div>
<div class="section" id="focus-on-common-tasks">
<h3>Focus on common tasks<a class="headerlink" href="#focus-on-common-tasks" title="Permalink to this heading"></a></h3>
<p>The UI targets the most common use cases (see <a class="reference internal" href="#common-tasks"><span class="std std-ref">Common Quantum Chemistry Calculations</span></a>), but should
try to be flexible. At some point, harnessing the full power of the code
requires forgoing the UI and dropping down to PluginPlay’s API.</p>
</div>
<div class="section" id="minimal-dependencies">
<h3>Minimal dependencies<a class="headerlink" href="#minimal-dependencies" title="Permalink to this heading"></a></h3>
<p>The UI is designed to be a thin-layer on top of the PluginPlay API and should
have minimum number of dependencies. This improves maintainability and reduces
the risk of breaking the code due to changes in the dependencies.</p>
</div>
<div class="section" id="archiving-and-reproducibility">
<h3>Archiving and reproducibility<a class="headerlink" href="#archiving-and-reproducibility" title="Permalink to this heading"></a></h3>
<p>The UI should support archiving and reproducibility by providing the user with a
way to save the input and output data for each calculation. This not only serves
as a tool for managing and organizing data but also plays an integral role in
facilitating reproducibility.</p>
</div>
</div>
<div class="section" id="common-quantum-chemistry-calculations">
<span id="common-tasks"></span><h2>Common Quantum Chemistry Calculations<a class="headerlink" href="#common-quantum-chemistry-calculations" title="Permalink to this heading"></a></h2>
<p>As described in the design principles, the UI should enable users to conduct
commonly used quantum chemistry calculations such as single-point energies and
geometry optimizations in as few steps as possible. It should also be flexible
enough to allow for more complex workflows using the helper/driver functions and
PluginPlay modules. Users can execute these calculations either via Python
scripts or interactively using Jupyter notebooks. For those who desire a
fine-grained control of their workflow, they can utilize the Python and/or C++
API.</p>
<ol class="arabic">
<li><p><strong>Single Point Energy</strong></p>
<p>In these calculations total energy is computed for a fixed geometry of the
molecule (arrangement of atomic nuclei) corresponding to a single point in
the potential energy surface. While energy calculation is the most common
case, the user might be interested in obtaining the wave function,
derivatives, or other properties (dipole moment, electron density, etc.) for
this specific geometry.</p>
</li>
<li><p><strong>Geometry Optimization</strong></p>
<p>This is a procedure to find the arrangement of atomic nuclei that corresponds
to a stationary point in the potential energy surface. This procedure
generally requires the calculation of the gradients and Hessian (first and
second order partial derivatives of the energy with respect to nuclear
coordinates, respectively) at many different geometries.</p>
</li>
<li><p><strong>Vibrational Frequency Calculation</strong></p>
<p>These calculations provide the vibrational modes of a molecule and their
corresponding frequencies. The procedure requires Hessian calculation at the
equilibrium  geometry.</p>
</li>
<li><p><strong>Molecular Dynamics Simulation</strong></p>
<p>These calculations allow for the study of the trajectory of atoms and
molecules over time using classical dynamics. Gradient calculations are
required to compute the forces acting on the atoms.</p>
</li>
</ol>
<p>We will initially focus on the UI design of the “single point energy”
calculations in this document since other types of calculations (geometry
optimization, vibrational frequency calculation, etc.) require similar inputs.</p>
<p>Before we delve into the specifics of the NWChemEx UX, we provide examples of
restricted Hartree–Fock (RHF) energy calculations for a hydrogen molecule using
PySCF, PSI4, and MolSSI QCEngine. Finally, we will provide an NWChemEx example
and discuss about the choices made.</p>
</div>
<div class="section" id="existing-python-based-uis">
<h2>Existing Python-based UIs<a class="headerlink" href="#existing-python-based-uis" title="Permalink to this heading"></a></h2>
<div class="section" id="pyscf">
<h3>PySCF<a class="headerlink" href="#pyscf" title="Permalink to this heading"></a></h3>
<p>PySCF is a Python-based open-source quantum chemistry package distributed under
the Apache License 2.0. The code is written mostly in Python (~90%), while
computational hot spots are written in C following C89 standard. Most functions
are pure (exceptions are named with a suffix underscore) and functional
programming is preferred over object oriented style as described in their <a class="reference external" href="https://pyscf.org/code-rule.html">code
standard</a>.</p>
<p>Below you can find how to run an RHF calculation for a hydrogen molecule using
PySCF.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">M</span><span class="p">(</span><span class="n">atom</span><span class="o">=</span><span class="s1">&#39;O 0 0 0; H 0 1 0; H 0 0 1&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto-3g&#39;</span><span class="p">)</span>
<span class="n">rhf</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">rhf</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
<p>Here, mol is the object (type <code class="docutils literal notranslate"><span class="pre">pyscf.gto.mole.Mole</span></code>) representing the molecule
and integrals with the given basis set and rhf is the object (type
<code class="docutils literal notranslate"><span class="pre">pyscf.scf.hf.RHF</span></code>) that holds method specific information. The energy is
computed using the <code class="docutils literal notranslate"><span class="pre">kernel()</span></code> function.</p>
</div>
<div class="section" id="psi4">
<h3>PSI4<a class="headerlink" href="#psi4" title="Permalink to this heading"></a></h3>
<p>PSI4 is a C++/Python (70%/30%) open-source quantum chemistry package distributed
under the LGPL3 license. PSI4 provides two different types of UI referred to as
Psithon and PsiAPI modes. In the Psithon mode, the user writes an input file in
a domain specific language similar to Python. In the PsiAPI mode, the user can
write a pure Python script that interacts with PSI4 as a Python module. Since
the latter is more relevant to our design, we show below how to run an RHF
calculation for a hydrogen molecule using the PsiAPI mode.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">psi4</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s1">&#39;H 0. 0. 0. </span><span class="se">\n</span><span class="s1"> H 0. 0. 1.&#39;</span><span class="p">)</span>
<span class="n">energy</span><span class="o">=</span> <span class="n">psi4</span><span class="o">.</span><span class="n">energy</span><span class="p">(</span><span class="s1">&#39;scf/sto-3g&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, mol is the molecule object, which is created using the <code class="docutils literal notranslate"><span class="pre">psi4.geometry()</span></code>
function and the energy is computed using the <code class="docutils literal notranslate"><span class="pre">psi4.energy()</span></code> function, which
takes the method name as the required argument. Note that the user do not need
to pass the molecule object explicitly to the subsequent energy calculation. By
default energy is computed for the last molecule defined with the
<code class="docutils literal notranslate"><span class="pre">psi4.geometry()</span></code> function. Additional options can be set with the
<code class="docutils literal notranslate"><span class="pre">psi4.set_options()</span></code> function, which takes a Python dictionary as the required
argument.</p>
</div>
<div class="section" id="qcengine">
<h3>QCEngine<a class="headerlink" href="#qcengine" title="Permalink to this heading"></a></h3>
<p>QCEngine is a general purpose quantum chemistry program interface. It is a
Python library that provides a common API for quantum chemistry programs.
QCEngine is an open-source package distributed under the Apache License 2.0.</p>
<p>Below you can find how to run an RHF calculation for a hydrogen molecule using
QCEngine.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">qcengine</span> <span class="k">as</span> <span class="nn">qcng</span>
<span class="kn">import</span> <span class="nn">qcelemental</span> <span class="k">as</span> <span class="nn">qcel</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">qcel</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="s1">&#39;H 0. 0. 0. </span><span class="se">\n</span><span class="s1"> H 0. 0. 1.&#39;</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">qcng</span><span class="o">.</span><span class="n">compute</span><span class="p">({</span><span class="s2">&quot;molecule&quot;</span><span class="p">:</span> <span class="n">mol</span><span class="p">,</span> <span class="s2">&quot;driver&quot;</span><span class="p">:</span> <span class="s2">&quot;energy&quot;</span><span class="p">,</span> <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;method&quot;</span><span class="p">:</span>
<span class="s2">&quot;SCF&quot;</span><span class="p">,</span> <span class="s2">&quot;basis&quot;</span><span class="p">:</span> <span class="s2">&quot;sto-3g&quot;</span><span class="p">}},</span> <span class="s2">&quot;NWChemEx&quot;</span><span class="p">)</span>
<span class="n">energy</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">return_result</span>
</pre></div>
</div>
<p>Here, mol is the molecule object (type
<code class="docutils literal notranslate"><span class="pre">qcelemental.models.molecule.Molecule</span></code>), which is created using the
<code class="docutils literal notranslate"><span class="pre">qcel.models.Molecule.from_data()</span></code> function from QCElemental package. The RHF
energy is computed using the <code class="docutils literal notranslate"><span class="pre">qcng.compute()</span></code> function, from QCEngine package.
Note that, the input for the <code class="docutils literal notranslate"><span class="pre">qcng.compute</span></code> function is a Python dictionary
with a schema defined by QCElemental.</p>
</div>
</div>
<div class="section" id="current-nwchemex-ui">
<h2>Current NWChemEx UI<a class="headerlink" href="#current-nwchemex-ui" title="Permalink to this heading"></a></h2>
<p>The backbone of the current NWChemEx UI is the <cite>calculate()</cite> function. This
function enables users to run quantum chemistry methods implemented in NWChemEx,
with a very simple interface. The signature of this function is given below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="n">molecule</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">chemist</span><span class="o">.</span><span class="n">Molecule</span><span class="p">],</span>
<span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">basis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">chemist</span><span class="o">.</span><span class="n">AOBasisSet</span><span class="p">,</span> <span class="n">simde</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">ao_space</span><span class="p">],</span>
<span class="n">task</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;energy&quot;</span><span class="p">,</span> <span class="s2">&quot;gradient&quot;</span><span class="p">,</span> <span class="s2">&quot;wavefunction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;energy&quot;</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span>
<span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
</pre></div>
</div>
<p>In this function, there are three required arguments. First one is the molecule,
which can be given as a Python string or a dictionary-like object (composed of
key-value pairs) that contains the information required to create a
<code class="docutils literal notranslate"><span class="pre">chemist.Molecule</span></code> object. The user can also pass a <code class="docutils literal notranslate"><span class="pre">chemist.Molecule</span></code>
object directly. The second required argument is the <code class="docutils literal notranslate"><span class="pre">method</span></code>, which is a
Python string that corresponds to one of the quantum chemistry methods
implemented in NWChemEx. The third required argument is the <code class="docutils literal notranslate"><span class="pre">basis</span></code>, which can
be given as a Python string or a <code class="docutils literal notranslate"><span class="pre">chemist.AOBasisSet</span></code> object or a
<code class="docutils literal notranslate"><span class="pre">simde.type.ao_space</span></code> object. The <code class="docutils literal notranslate"><span class="pre">calculate()</span></code> function also takes optional
arguments. <code class="docutils literal notranslate"><span class="pre">task</span></code> argument enables users to choose the type of calculation,
which can be <code class="docutils literal notranslate"><span class="pre">energy</span></code> (default), <code class="docutils literal notranslate"><span class="pre">gradient</span></code>, or <code class="docutils literal notranslate"><span class="pre">wavefunction</span></code> currently,
but this list is expected to grow as more functionalities are added to NWChemEx.
<code class="docutils literal notranslate"><span class="pre">options</span></code> argument enables users to customize the calculation further by
modifying different parameters related to the selected <code class="docutils literal notranslate"><span class="pre">method</span></code> and <code class="docutils literal notranslate"><span class="pre">task</span></code>. At
this point, it is an opaque type (to be designed later in coordination with
PluginPlay <a class="reference external" href="https://github.com/NWChemEx/PluginPlay/issues/308">#308</a>),
which is capable of holding key/value pairs for inputs similar to a Python
dictionary. Alternatively, key/value pairs can be passed directly to the
function call as <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>. The return type of the <code class="docutils literal notranslate"><span class="pre">calculate()</span></code> function is
also an opaque type that can hold key/value pairs.</p>
<p>With the <code class="docutils literal notranslate"><span class="pre">calculate()</span></code> function, a user can run the RHF example by
specifying only the required arguments as shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nwchemex</span> <span class="k">as</span> <span class="nn">nwx</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">nwx</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">molecule</span> <span class="o">=</span> <span class="s1">&#39;H 0. 0. 0. </span><span class="se">\n</span><span class="s1"> H 0., 0. 1.&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;scf&#39;</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">method</span> <span class="pre">=</span> <span class="pre">'scf'</span></code> will default to the RHF energy calculation since the
molecule is a closed-shell system and default value for the <code class="docutils literal notranslate"><span class="pre">task</span></code> is a single
point energy calculation.</p>
<div class="section" id="parallel-calculations">
<h3>Parallel calculations<a class="headerlink" href="#parallel-calculations" title="Permalink to this heading"></a></h3>
<p>NWChemEx also provides a simple interface to run calculations in parallel. Here,
we provide an example where the user wants to run a potential energy surface
scan, which is basically an embarrassingly parallel workflow composed of single
point energy calculations at different geometries. The user can run this
workflow in two different ways:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the parallel environment with mpi4py</span>
<span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span>
<span class="n">comm</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span>
<span class="n">rank</span> <span class="o">=</span> <span class="n">comm</span><span class="o">.</span><span class="n">Get_rank</span><span class="p">()</span>

<span class="c1"># Use one rank per sub-communicator</span>
<span class="n">sub_comm</span> <span class="o">=</span> <span class="n">comm</span><span class="o">.</span><span class="n">Split</span><span class="p">(</span><span class="n">rank</span><span class="p">)</span>
<span class="c1"># Define the distance between atoms based on the global rank</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">+</span> <span class="n">rank</span> <span class="o">*</span> <span class="mf">0.1</span>

<span class="c1"># Alternative 1</span>
<span class="c1"># Initialize NWChemEx runtime with the sub-communicator</span>
<span class="n">nwx_comm</span> <span class="o">=</span> <span class="n">nwx</span><span class="o">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">sub_comm</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">nwx</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">molecule</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;H 0. 0. 0. </span><span class="se">\n</span><span class="s1"> H 0. 0. </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;scf&#39;</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Energy calculated by rank: </span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s1"> for distance: </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1"> is </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">scf_energy</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Alternative 2</span>
<span class="c1"># Initialize NWChemEx runtime inside the function call</span>
<span class="c1"># Sub-communicator can be passed directly or through the options argument</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">nwx</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">molecule</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;H 0. 0. 0. </span><span class="se">\n</span><span class="s1"> H 0. 0. </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;scf&#39;</span><span class="p">,</span> <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;sto-3g&#39;</span><span class="p">,</span> <span class="n">communicator</span> <span class="o">=</span> <span class="n">sub_comm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Energy calculated by rank: </span><span class="si">{</span><span class="n">rank</span><span class="si">}</span><span class="s1"> for distance: </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1"> is </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">scf_energy</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="not-in-scope">
<span id="id2"></span><h2>Not In Scope<a class="headerlink" href="#not-in-scope" title="Permalink to this heading"></a></h2>
<p><strong>Graphical user interface (GUI)</strong></p>
<p>Arguably a GUI represents the pinnacle of UX; however, we presently are focused
on a programmatic UI. Implementing a GUI is an orthogonal task that can benefit
from the existence of the programmatic UI.</p>
<p><strong>Interfaces for driving NWChemEx</strong></p>
<p>While we want NWChemEx to be part of an ecosystem, the design on this page is
purely focused on a UI which uses a combination of native NWChemEx and Python
objects.</p>
<blockquote>
<div><ul class="simple">
<li><p>With a NWChemEx UI in place driving NWChemEx from other packages becomes easier.</p></li>
<li><p>Ideally such interfaces should be maintained on the driver’s side, and not
by us, in order to avoid needing to weigh down NWChemEx with additional
dependencies. Note that making a dependency optional for a user does NOT
negate this as NWChemEx developers must support all optional features.</p></li>
</ul>
</div></blockquote>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="energy_workflow.html" class="btn btn-neutral float-left" title="Energy Workflow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="faqs.html" class="btn btn-neutral float-right" title="FAQs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, NWChemEx Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>